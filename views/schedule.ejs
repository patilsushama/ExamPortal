
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="style.css">
  
    <style>
        /* schdule css */
        .main {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }

        .sc1,
        .sc2 {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            flex: 1;
        }

        form input,
        form select,
        form button {
            display: block;
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }

        form button {
            background-color: #2c699a;
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        table th, table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }

        table th {
            background-color: #2c699a;;
            color: white;
        }

        .btn {
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
        }


        .updatebtn,
.deletebtn {
  display: inline-block;
  padding: 4px 6px;
  text-decoration: none;
  color: white;
  border-radius: 4px;
  font-weight: bold;
  margin-right: 5px;
  transition: background-color 0.3s ease;
}


    </style>
</head>
<body>

  <div class="header">
    Welcome to Exam Application System
  </div>

  <div class="slider">
    <div class="s1">
      <h3>Admin</h3>
       <a href="/adinfo">üë®‚Äçüíº Admin</a>
      <a href="/course">üìö Subject</a>  
      <a href="/examinfo">üìù Exam</a>
      <a href="/questioninfo">‚ùì Questions</a>
      <a href="/schedule"> üìÖ Schedule</a>
      <a href="/logoutadmin">üö™ Home</a>
    </div>

    <div class="s2">
        <div class="main">
        <div class="sc1">
            <h2 style="color:#24587f;"><%= selectedSchedule ? "Update Schedule Form" : "Schedule Form" %></h2>
<form action="<%= selectedSchedule ? '/scheduleupdate' : '/schedulesave' %>" method="POST">
  <% if (selectedSchedule) { %>
    <input type="hidden" name="schid" value="<%= selectedSchedule.schid %>">
  <% } %>

  <input type="date" id="examDate" name="date" value="<%= selectedSchedule ? selectedSchedule.date.toISOString().split('T')[0] : '' %>" required>


  <span id="dateError" style="color:red; font-size:0.9em;"></span>
  <input type="time"   name="starttime" value="<%= selectedSchedule ? selectedSchedule.starttime : '' %>" required>
  <input type="time"   name="endtime" value="<%= selectedSchedule ? selectedSchedule.endtime : '' %>" required>

  <select name="cid" required>
    <% courses.forEach((c) => { %>
      <option value="<%= c.cid %>" <%= selectedSchedule && selectedSchedule.cid === c.cid ? 'selected' : '' %>><%= c.cname %></option>
    <% }) %>
  </select>

  <select name="eid" required>
    <% exams.forEach((e) => { %>
      <option value="<%= e.ex_id %>" <%= selectedSchedule && selectedSchedule.ex_id === e.ex_id ? 'selected' : '' %>><%= e.exname %></option>
    <% }) %>
  </select>

  <button type="submit"><%= selectedSchedule ? 'Update' : 'Submit' %></button>
</form>


        </div>
        <div class="sc2">

            <h2 style= "color:#24587f;">Schedule List</h2>
            <table border="1">
                <tr>
                    <th>Sr.No</th>
                    <th>Date</th>
                    <th>Start</th>
                    <th>End</th>
                    <th>Course</th>
                    <th>Exam</th>
                    <th>Actions</th>
                </tr>
                <% schedules.forEach((s, i)=> { %>
                    <tr>
                        <td>
                            <%= i+1 %>
                        </td>

                       <td><%= new Date(s.date).toISOString().split('T')[0] %></td>

                       <td class="time24"><%= s.starttime %></td>
                    <td class="time24"><%= s.endtime %></td>

                        <td>
                            <%= s.course %>
                        </td>
                        <td>
                            <%= s.exam %>
                        </td>
                         <td>
                        <a href="/schedule?edit=<%= s.schid %>"  >üìù</a>
                        <a href="/deleteschdule?id=<%= s.schid %>" >üóëÔ∏è</a>
                        </td>

                    </tr>
                    <% }) %>
            </table>
        </div>
    </div>



    </div>
  </div>
<script>

  const examDateInput = document.getElementById("examDate");
  const today = new Date().toISOString().split('T')[0];
  examDateInput.setAttribute("min", today);
// time validateion convert into 24 to 12

  function convertTo12HourFormat(time24) {
    const [hour, minute] = time24.split(':');
    const h = parseInt(hour);
    const suffix = h >= 12 ? 'PM' : 'AM';
    const hour12 = h % 12 === 0 ? 12 : h % 12;
    return `${hour12}:${minute} ${suffix}`;
  }

  document.querySelectorAll('.time24').forEach(el => {
    const original = el.textContent.trim();
    if (original.includes(':')) {
      el.textContent = convertTo12HourFormat(original);
    }
  });

  // Date validation
  const dateError = document.getElementById("dateError");
  examDateInput.addEventListener("input", function () {
    const selectedDate = new Date(this.value);
    const todayDate = new Date(today);
    if (!this.value) {
      dateError.textContent = "Please select a date.";
      this.style.border = "2px solid red";
    } else if (selectedDate < todayDate) {
      dateError.textContent = "Previous dates are not allowed.";
      this.style.border = "2px solid red";
    } else {
      dateError.textContent = "";
      this.style.border = "1px solid #ccc";
    }
  });
</script>



</body>
</html>
